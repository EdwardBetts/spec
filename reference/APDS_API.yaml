openapi: 3.0.0
info:
  title: APDS
  version: '1.0'
  description: |-
    Allows the standard CRUD operations, as well as listing/search of:

    * `Places` (and their `Occupancy`)
    * `Rates`
    * `RightSpecifications`
    * `AssignedRights`
    * `Sessions`
    * `Observations`
  contact: {}
tags:
  - name: create
    description: Create an assigned right
  - name: read
    description: Read an assigned right
  - name: update
    description: Update an assigned right
  - name: delete
    description: Delete an assigned right
  - name: list
    description: List (search) assigned rights
servers:
  - url: ''
paths:
  '/rights/assigned/{id}':
    parameters:
      - schema:
          type: string
        name: id
        in: path
        description: 'Identifier for the assigned right. When not provided, the `right_spec`, `credential_class` and `credential_id` query params **must** be provided'
        required: true
    delete:
      summary: Delete AssignedRight
      operationId: delete-assigned_right
      responses:
        '200':
          description: OK
      tags:
        - delete
      description: Delete an existing `Assigned Right`
    put:
      summary: Update AssignedRight
      operationId: update-assigned_right
      responses:
        '200':
          description: OK
      description: Update an existing `AssignedRight`
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties: {}
      tags:
        - update
    get:
      summary: Get an AssignedRight
      operationId: read-assigned_right
      description: Get latest version of a given `AssignedRight` by its identifier
      tags:
        - read
      parameters: []
      responses:
        '200':
          description: OK
  /rights/assigned:
    parameters: []
    post:
      summary: Create a new AssignedRight
      responses:
        '200':
          description: OK
      operationId: create-assigned_right
      description: Create a new `AssignedRight`
      requestBody:
        description: This method allows an issuer to assign a parking right to a holder
        content:
          application/json:
            schema:
              type: object
              properties: {}
      tags:
        - create
    get:
      summary: List AssignedRights
      operationId: list-assigned_rights
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: ../models/common/PaginatedListMeta.yaml
                  - type: object
                    properties:
                      deletedReferences:
                        type: array
                        items:
                          $ref: ../models/common/DeletedReference.yaml
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: ../models/right/AssignedRight.yaml
      description: |-
        Lists `AssignedRights` and allows filtering by:

        * a combination of `HolderCredential` and `RightSpecification`, to check if a given credential has a given right to park
        * latitude, longitude, radius: to check for `AssignedRights` within a geographic area
        * a modification instant: to only display changed resources
      tags:
        - list
      parameters:
        - schema:
            type: string
          in: query
          name: right_spec
          description: Unique identifier for a right specification (its latest version is assumed)
        - schema:
            type: string
          in: query
          name: credential_class
          description: Class name for credential
        - schema:
            type: string
          in: query
          name: credential_id
          description: Unique identifier for credential in given class
        - schema:
            type: string
            enum:
              - all
              - none
              - plannedUses
              - assignedRightIssuer
          in: query
          name: expand
          description: Comma separated list of optional object attributes associated to an `AssignedRight` that should be included in the result set
        - $ref: '#/components/parameters/lat'
        - $ref: '#/components/parameters/long'
        - $ref: '#/components/parameters/radius'
        - $ref: '#/components/parameters/mod'
components:
  parameters:
    lat:
      schema:
        type: number
        format: float
      in: query
      name: latitude
      description: Location latitude to use as filter (mandatory if longitude or radius are defined)
    long:
      schema:
        type: number
        format: float
      in: query
      name: longitude
      description: Location longitude to use as filter (mandatory if longitude or radius are defined)
    radius:
      schema:
        type: integer
        minimum: 0
      in: query
      name: radius
      description: Number of meters to use as search filter from given latitude and longitude (mandatory if latitude or longitude are defined)
    mod:
      schema:
        type: integer
        minimum: 0
      in: query
      name: modified_since
      description: "Reference timestamp to only display resources that have changed after that instant (represented as seconds, in UTC, since epoch).\n\n* If `expand` attributes are requested, then this timestamp will also applyto those objects’ modifications \n* When this attribute is used, the result-set will also include a list of deleted resources’ IDs, so that the client can use this method to avoid storing stale data"
